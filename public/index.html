<!-- Simple launcher when webserver root is accessed. -->
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="/lib/bootstrap.css" />
  <style>
    .list-group {margin-bottom: 0}
    .list-group-item {border-left: 0; border-right: 0; }
    .no-top {border-top: 0}
    .center {  position:absolute; top:50%; left:50%; transform: translate(-50%,-50%); }
    .main-panel { padding: 0 }
  </style>
  <body oncontextmenu="return false">

    <script src="/lib/mithril.js"></script>
    <script>
      var Login = {
        'controller': function(args) {
          return {
            'type': undefined
          };
        },
        'view': function(ctrl, args) {
          var innerComponent = typeof ctrl.type === 'undefined' ? UserTypeSelect : EmailAddressEnter;
          return m('div.row',
            m('div.col-sm-6.col-sm-offset-3.col-md-4.col-md-offset-4',
              m('div.panel.panel-default',
                m('.panel-heading', "CCAF launcher"),
                m('.panel-body.main-panel',
                  m.component(innerComponent, {'ctrl': ctrl})
                )
              )
            )
          );
        }
      };

      var UserTypeSelect = {
        'view': function(_, args) {
          var handler = {
            'onclick': function(e) {
              args.ctrl.type = e.target.innerText;
            }
          };

          return m('span',
            m('.list-group',
              m('a.list-group-item.no-top', handler,
                m('h4.list-group-item-heading', "Student")
              ),
              m('a.list-group-item', handler,
                m('h4.list-group-item-heading', "Teacher")
              )
            )
          );
        }
      };

      var EmailAddressEnter = {
        'view': function(_, args) {
          return m('input.form-control', {
            'placeholder': "email address",
            'onkeypress': function(e) {
              if (e.keyCode === 13)
                  location.href = (args.ctrl === "Student" ? 'client' : 'console') + "?email=" + e.target.value;
            }
          });
        }
      }

      m.mount(document.body, Login);
    </script>
  </body>
</html>
