define(['clientUtil', 'exports', 'mithril', 'interact'], function(clientUtil, exports, m, interact) {
  var setSnippet;
  exports.load = function(el, action, store, params) {
    clientUtil.css('apps/mysteries/styles.css')

    action('snippets-init')
      .onReceive(function() {
        this.snippets = this.snippets || [{'src': "data:image/gif;base64,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", 'x': 0, 'y': 0, 'a': 0, 's': 1}];
      });

    action('set-snippet-location')
      .onReceive(function(snippet, x, y, a, s) {
        this.snippets[snippet].x = x;
        this.snippets[snippet].y = y;
        this.snippets[snippet].a = a;
        this.snippets[snippet].s = s;
      });

    setSnippet = function(snippet, x, y, a, s) {
      store.sendAction('set-snippet-location', snippet, x, y, a, s);
    };

    store.sendAction('snippets-init');
    store.addObserver(function(store, old) {
      if (!old)
        m.mount(el, m.component(Snippets, store.snippets));
      else
        m.render(el, m.component(Snippets, store.snippets));
      m.redraw(true);
    })
  };

  var Snippets = {
    'controller': function(args) {

    },
    'view': function(ctrl, snippets) {
      return m('span',
        snippets.map(function(snippet, i) {
          return m('div.snippet', {
            'data-i': i,
            'data-x': snippet.x,
            'data-y': snippet.y,
            'data-a': snippet.a,
            'data-s': snippet.s,
            'style': 'transform: translate(' + snippet.x + 'px, ' + snippet.y + 'px) rotate(' + snippet.a + 'deg) scale(' + snippet.s +')'
          }, m('img', {
            'src': snippet.src
          }));
        })
      );
    }
  };

  var listener = function(event) {
    var target = event.target,
        x = (parseFloat(target.getAttribute('data-x')) || 0) + (event.dx || 0),
        y = (parseFloat(target.getAttribute('data-y')) || 0) + (event.dy || 0),
        a = (parseFloat(target.getAttribute('data-a')) || 0) + (event.da || 0),
        s = (parseFloat(target.getAttribute('data-s')) || 1) * (1 + (event.ds || 0));

    if (s > 3)
      s = 3;
    if (s < 0.5)
      s = 0.5;

    setSnippet(target.getAttribute('data-i'), x, y, a, s);
  };

  interact('.snippet')
    .draggable({
      inertia: true,
      onmove: listener
    })
    .gesturable({
      onmove: listener
    });

});
